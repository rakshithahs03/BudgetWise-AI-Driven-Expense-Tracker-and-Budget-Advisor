<app-alert
  *ngIf="showAlert"
  [message]="alertMessage"
  [type]="alertType"
  (close)="showAlert = false"
></app-alert>

<div class="forum-container">
  <div class="page-header">
    <h1>Community Forum</h1>
    <p>Share tips, ask questions, and connect with other BudgetWise users.</p>
  </div>

  <div class="create-post-card">
    <h3>Create a New Post</h3>
    <form (ngSubmit)="onSubmitPost()">
      <div class="form-group">
        <input type="text" placeholder="Post Title" [(ngModel)]="newPost.title" name="title" required>
      </div>
      <div class="form-group">
        <textarea placeholder="What's on your mind?" [(ngModel)]="newPost.content" name="content" rows="4" required></textarea>
      </div>
      <button type="submit" class="submit-btn">Submit Post</button>
    </form>
  </div>

  <div class="post-list">
    <h2>Recent Posts</h2>
    @if(isLoading) {
      <div class="loading-state">Loading posts...</div>
    } @else {
      @for(post of posts; track post.id) {
        <a [routerLink]="['/forum', post.id]" class="post-card-link">
          <div class="post-card">
            <h3 class="post-title">{{ post.title }}</h3>
            <p class="post-content-excerpt">{{ post.content | slice:0:150 }}...</p>
            <div class="post-meta">
              <span>Posted by: <strong>{{ post.author.username }}</strong></span>
              <span>{{ post.comments.length }} comments</span>
            </div>
          </div>
        </a>
      } @empty {
        <div class="empty-state">
          <h3>No posts yet...</h3>
          <p>Be the first to start a conversation!</p>
        </div>
      }
    }
  </div>
</div>
